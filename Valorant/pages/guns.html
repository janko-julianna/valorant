<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valorant Fegyverek - Részletes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../css/style.css" />
  <style>
    .skin-img { height: 50px; margin-right: 5px; border-radius: 5px; }
    .weapon-stats { font-size: 0.9rem; }
    .weapon-card-body { min-height: 300px; }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="../index.html">
        <img src="../images/logo.png" alt="Valorant" height="60" />
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="../index.html">Főoldal</a></li>
          <li class="nav-item"><a class="nav-link active" href="guns.html">Fegyverek</a></li>
          <li class="nav-item"><a class="nav-link" href="agents.html">Agentek</a></li>
          <li class="nav-item"><a class="nav-link" href="maps.html">Mapok</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <section class="container py-5 text-center">
    <h1 class="section-title">Valorant Fegyverek</h1>
    <input type="text" id="search" class="form-control w-50 mx-auto my-4" placeholder="Keresés fegyverre..." />
    <div id="filters" class="mb-4"></div>
  </section>

  <section class="container pb-5">
    <div class="row g-4" id="weapon-list"></div>
  </section>

  <footer>
    <div class="container">
      <div class="row align-items-center mb-3">
        <div class="col-md-6 text-center text-md-start mb-2 mb-md-0">
          <img src="../images/logo.png" alt="Valorant" height="40" class="me-2 align-middle" />
          <span class="fw-bold fs-5 align-middle">Valorant Fegyverek</span>
        </div>
        <div class="col-md-6 text-center text-md-end">
          <a href="../index.html" class="me-3">Fooldal</a>
          <a href="guns.html" class="me-3">Fegyverek</a>
          <a href="agents.html" class="me-3">Agentek</a>
          <a href="maps.html">Mapok</a>
        </div>
      </div>
      <div class="row">
        <div class="col text-center small">
          &copy; 2025 valorant
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const weaponList = document.getElementById("weapon-list");
    const searchInput = document.getElementById("search");
    const filters = document.getElementById("filters");

    let allWeapons = [];
    let selectedCategory = "all";

    async function loadWeapons() {
      try {
        const response = await axios.get("https://valorant-api.com/v1/weapons");
        allWeapons = response.data.data.filter(w => w.displayIcon); // Csak azok, amiknek van képe
        renderWeapons();
        renderCategoryButtons();
      } catch (error) {
        console.error("Hiba történt a fegyverek betöltésekor:", error);
      }
    }

    function renderWeapons() {
      weaponList.innerHTML = "";

      const searchText = searchInput.value.toLowerCase();

      allWeapons.forEach(weapon => {
        const name = weapon.displayName.toLowerCase();
        const category = weapon.category.toLowerCase();

        const matchesSearch = name.includes(searchText);
        const matchesCategory = selectedCategory === "all" || category === selectedCategory;

        if (matchesSearch && matchesCategory) {
          const card = document.createElement("div");
          card.className = "col-sm-6 col-md-4 col-lg-3";
          card.innerHTML = `
            <div class="card h-100 bg-dark text-white border-0 rounded-4 shadow-sm">
              <img src="${weapon.displayIcon}" class="card-img-top p-3 bg-black" style="height:220px;">
              <div class="card-body d-flex flex-column justify-content-between">
                <div>
                  <h5 class="card-title text-center">${weapon.displayName}</h5>
                  <p class="text-center mb-3">${weapon.category.replace("EEquippableCategory::", "")}</p>
                  ${weapon.weaponStats ? `
                  <ul class="list-unstyled weapon-stats text-start">
                    <li><strong>Tűzgyorsaság:</strong> ${weapon.weaponStats.fireRate} lövés/mp</li>
                    <li><strong>Tárkapacitás:</strong> ${weapon.weaponStats.magazineSize}</li>
                    <li><strong>Felszerelési idő:</strong> ${weapon.weaponStats.equipTimeSeconds}s</li>
                    <li><strong>Újratöltési idő:</strong> ${weapon.weaponStats.reloadTimeSeconds}s</li>
                    <li><strong>Falszúrás:</strong> ${weapon.weaponStats.wallPenetration.replace("EWallPenetrationDisplayType::", "")}</li>
                    <li><strong>Ár:</strong> ${weapon.shopData?.cost ?? 'N/A'} kredit</li>
                    ${weapon.skins.slice(0, 5).map(skin => `
                      <li>
                        <img src="${skin.displayIcon}" alt="${skin.displayName}" class="skin-img" />
                      </li>
                    `).join('')}
                  </ul>` : '<p class="text-muted">Nincsenek részletes statisztikák.</p>'}
                </div>
              </div>
            </div>
          `;
          weaponList.appendChild(card);
        }
      });
    }

    function renderCategoryButtons() {
      const categories = ["all", ...new Set(allWeapons.map(w => w.category.toLowerCase()))];
      filters.innerHTML = "";

      categories.forEach(cat => {
        const button = document.createElement("button");
        button.textContent = cat === "all" ? "Mind" : cat.replace("eequippablecategory::", "");
        button.className = "btn btn-outline-light btn-sm me-2";
        if (cat === selectedCategory) button.classList.add("active");

        button.addEventListener("click", () => {
          selectedCategory = cat;
          renderCategoryButtons();
          renderWeapons();
        });

        filters.appendChild(button);
      });
    }

    searchInput.addEventListener("input", renderWeapons);
    loadWeapons();
  });
  </script>

</body>
</html>
