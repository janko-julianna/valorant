<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valorant Fegyverek - Részletes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../css/style.css" />
  <style>
    .skin-img { height: 50px; margin-right: 5px; border-radius: 5px; }
    .weapon-stats { font-size: 0.9rem; }
    .weapon-card-body { min-height: 300px; }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="../index.html">
        <img src="../images/logo.png" alt="Valorant" height="60" />
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="../index.html">Főoldal</a></li>
          <li class="nav-item"><a class="nav-link active" href="guns.html">Fegyverek</a></li>
          <li class="nav-item"><a class="nav-link" href="agents.html">Agentek</a></li>
          <li class="nav-item"><a class="nav-link" href="maps.html">Mapok</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <section class="container py-5 text-center">
    <h1 class="section-title">Valorant Fegyverek - Részletes</h1>
    <input type="text" id="search" class="form-control w-50 mx-auto my-4" placeholder="Keresés fegyverre..." />
    <div id="filters" class="mb-4"></div>
  </section>

  <section class="container pb-5">
    <div class="row g-4" id="weapon-list"></div>
  </section>

  <footer>
    <div class="container">
      <div class="row align-items-center mb-3">
        <div class="col-md-6 text-center text-md-start mb-2 mb-md-0">
          <img src="../images/logo.png" alt="Valorant" height="40" class="me-2 align-middle" />
          <span class="fw-bold fs-5 align-middle">Valorant Fegyverek</span>
        </div>
        <div class="col-md-6 text-center text-md-end">
          <a href="../index.html" class="me-3">Főoldal</a>
          <a href="guns.html" class="me-3">Fegyverek</a>
          <a href="agents.html" class="me-3">Agentek</a>
          <a href="maps.html">Mapok</a>
        </div>
      </div>
      <div class="row">
        <div class="col text-center small">
          &copy; 2025 Valorant Fegyverek | Készítette: Olivér | Nem hivatalos rajongói oldal
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    let weaponsData = [];
    let currentCategory = "all";

    function createWeaponCard(weapon) {
      // Kicsit kibővített HTML a statokkal és skinekkel
      const stats = weapon.weaponStats;
      const skins = weapon.skins || [];

      // Statok megjelenítése, ha elérhető
      const statsHtml = stats ? `
        <div class="weapon-stats mt-3">
          <div><strong>Fire Rate:</strong> ${stats.fireRate ?? 'N/A'}</div>
          <div><strong>Magazine Size:</strong> ${stats.magazineSize ?? 'N/A'}</div>
          <div><strong>Reload Time:</strong> ${stats.reloadTimeSeconds ? stats.reloadTimeSeconds.toFixed(2) + 's' : 'N/A'}</div>
          <div><strong>Wall Penetration:</strong> ${stats.wallPenetration?.replace('EWallPenetrationDisplayType::','') ?? 'N/A'}</div>
        </div>
      ` : '';

      // Skinek képei kis ikonként
      const skinsHtml = skins.length ? skins.map(skin => `
        <img src="${skin.displayIcon || ''}" alt="${skin.displayName}" title="${skin.displayName}" class="skin-img" />
      `).join('') : '<em>Nincs skin</em>';

      return `
        <div class="col-sm-6 col-md-4 col-lg-3" data-category="${weapon.category.toLowerCase()}">
          <div class="card h-100 bg-dark text-white shadow-sm border-0 rounded-4 overflow-hidden">
            <img src="${weapon.displayIcon}" class="card-img-top object-fit-contain p-3 bg-black" alt="${weapon.displayName}" style="height: 220px;">
            <div class="card-body weapon-card-body d-flex flex-column justify-content-between">
              <h5 class="card-title fw-bold text-center">${weapon.displayName}</h5>
              <div class="badge-category text-center">${weapon.category.replace('EEquippableCategory::', '')}</div>
              ${statsHtml}
              <div class="mt-3 text-center">
                <strong>Skinek:</strong><br />
                ${skinsHtml}
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function createCategoryButtons(categories) {
      const filters = document.getElementById("filters");
      filters.innerHTML = "";

      const allBtn = document.createElement("button");
      allBtn.textContent = "Mind";
      allBtn.classList.add("active");
      allBtn.addEventListener("click", () => {
        currentCategory = "all";
        setActiveButton(allBtn);
        filterWeapons();
      });
      filters.appendChild(allBtn);

      categories.forEach(cat => {
        const btn = document.createElement("button");
        btn.textContent = cat.replace('EEquippableCategory::','');
        btn.addEventListener("click", () => {
          currentCategory = cat.toLowerCase();
          setActiveButton(btn);
          filterWeapons();
        });
        filters.appendChild(btn);
      });
    }

    function setActiveButton(activeBtn) {
      const buttons = document.querySelectorAll("#filters button");
      buttons.forEach(btn => btn.classList.remove("active"));
      activeBtn.classList.add("active");
    }

    function filterWeapons() {
      const weaponList = document.getElementById("weapon-list");
      const searchQuery = document.getElementById("search").value.toLowerCase();

      weaponList.querySelectorAll(".col-sm-6").forEach(card => {
        const name = card.querySelector(".card-title").textContent.toLowerCase();
        const category = card.getAttribute("data-category").toLowerCase();

        const matchesSearch = name.includes(searchQuery);
        const matchesCategory = currentCategory === "all" || category === currentCategory;

        card.style.display = matchesSearch && matchesCategory ? "block" : "none";
      });
    }

    async function loadWeapons() {
      try {
        const response = await axios.get("https://valorant-api.com/v1/weapons");
        weaponsData = response.data.data.filter(w => w.displayIcon);

        const weaponList = document.getElementById("weapon-list");
        weaponList.innerHTML = weaponsData.map(createWeaponCard).join("");

        const categories = [...new Set(weaponsData.map(w => w.category))].sort();

        createCategoryButtons(categories);

        const searchInput = document.getElementById("search");
        searchInput.addEventListener("input", filterWeapons);

      } catch (error) {
        console.error("Hiba történt a fegyverek betöltésekor:", error);
      }
    }

    document.addEventListener("DOMContentLoaded", loadWeapons);
  </script>
</body>
</html>
